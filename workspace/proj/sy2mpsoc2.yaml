pattern:
- name: top_main_source
  type: scan_sy
  interface:
  - {name: s2p1_shared, class: port, type: SmMBox, constructor: mk_sm_mbox}
  - {name: out, class: var, type: Int}
  - {name: st, class: state, type: Int, value: '0'}
  - {name: outputs, class: param, value:
        [{var: out, port: s2p1_shared, mutex: MUTEX_0_NAME}]}
  instance:
  - placeholder: ns_func
    component: source_func
    bind:
    - {replace: 1_ret,   with: out}
    - {replace: 2_state, with: st}
  - placeholder: mk_sm_mbox
    component: mkSmMbox
    bind: {replace: baseAddress, withText: 'ONCHIP_SHARED_0_BASE'}
  requirement:
    include: "system.h"

- name: top_main_p1_sink
  type: std_seq_composite
  interface:
  - {name: s2p1_shared, class: port, type: SmMBox, constructor: mk_sm_mbox_read}
  - {name: inp, class: var, type: Int}
  - {name: out, class: var, type: Int}
  - {name: inputs, class: param, value:
        [{var: inp, port: s2p1_shared, mutex: MUTEX_0_NAME}]}
  - {name: schedule, class: param, value: [p1, sink]}
  - {name: p12s, class: var, type: Int}
  instance:
  - placeholder: p1
    component: dummy_func
    bind:
    - {replace: 2_arg, with: inp}
    - {replace: 1_ret, with: p12s}

  - placeholder: sink
    component: sink_func
    bind:
     - {replace: 1_arg, with: p12s}

  - placeholder: mk_sm_mbox_read
    component: mkSmMbox
    bind: {replace: baseAddress, withText: 'ONCHIP_SHARED_0_BASE'}
  requirement:
    include: "system.h"

    
native:
- name: source_func
  interface:
  - {name: 2_state, class: iarg, type: Int}
  - {name: 1_ret, class: ret, type: Int}
  requirement: {include: "lib/funcs_sy.c"}

- name: dummy_func
  interface:
  - {name: 2_arg, class: iarg, type: Int}
  - {name: 1_ret, class: ret, type: Int}
  requirement: {include: "lib/funcs_sy.c"}

- name: sink_func
  interface: {name: 1_arg, class: iarg, type: Int}
  requirement:
  - include: "stdio.h"
  - include: "lib/funcs_sy.c"
