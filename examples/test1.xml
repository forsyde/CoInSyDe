<?xml version="1.0"?>
<!DOCTYPE ForSyDe-SY-to-C SYSTEM "test.dtd">
<CoInSyDe_Project>
    <!-- SOFTWARE PATTERNS -->
    <pattern name="preMoore" type="comb">
	<port name="i1" class="iArg" type="Bool"/>
	<port name="o1" class="oArg" type="Int"/>
	<instance placeholder="func" component="bool2int" call="function">
	    <bind replace="arg" with="i1"/>
	    <bind replace="ret" with="o1"/>
	</instance>
    </pattern>
    <pattern name="mainProcess_moore" type="moore">
	<port name="i1" class="iArg" type="Int"/>
	<port name="o1" class="oArg" type="Int"/>
	<intern name="st" class="state" type="Int" value="0"/>
	<instance placeholder="ns_func" component="+" call="inline">
	    <bind replace="arg1" with="st"/>
	    <bind replace="arg2" with="i1"/>
	    <bind replace="ret" with="st"/>
	</instance>
	<instance placeholder="od_func" component="id" call="inline">
	    <bind replace="arg" with="st"/>
	    <bind replace="ret" with="o1"/>
	</instance>
    </pattern>

    <!-- CUSTOM COMPOSITE FUNCTIONS -->
    <!-- Their instances imply scheduling -->
    <composite name="mainProcess" type="top" call="function">
	<port name="i" class="get" type="Bool"/>
	<port name="o" class="put" type="Int"/>
	<intern name="fromBool" class="var" type="Int"/>
	<instance placeholder="1" component="preMoore" call="inline">
	    <bind replace="i1" with="i"/>
	    <bind replace="o1" with="fromBool"/>
	</instance>
	<instance placeholder="2" component="mainProcess_moore" call="function">
	    <bind replace="i1" with="fromBool"/>
	    <bind replace="o1" with="o"/>
	</instance>
	<intern name="formatStr" class="parameter" value="%d"/>
	<instance placeholder="i" component="stdinRead" call="inline">
	    <bind replace="format" with="formatStr"/>
	</instance>
	<instance placeholder="o" component="stdoutWrite" call="inline">
	    <bind replace="format" with="formatStr"/>
	</instance>
    </composite>

    <!-- USER-PROVIDED CODE --> 
    <native name="bool2int">
	<port name="arg" class="iArg" type="Bool"/>
	<port name="ret" class="oArg" type="Int"/>
	<requirement include="./int2bool.c"/>
    </native>
</CoInSyDe_Project>
